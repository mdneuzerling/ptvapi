<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Departures from a given stop — departures • ptvapi</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Departures from a given stop — departures" />
<meta property="og:description" content="departures retrieves all upcoming departures for a given stop ID and route
type." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ptvapi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mdneuzerling/ptvapi/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Departures from a given stop</h1>
    <small class="dont-index">Source: <a href='https://github.com/mdneuzerling/ptvapi/blob/master/R/departures.R'><code>R/departures.R</code></a></small>
    <div class="hidden name"><code>departures.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>departures</code> retrieves all upcoming departures for a given stop ID and route
type.</p>
    </div>

    <pre class="usage"><span class='fu'>departures</span>(
  <span class='no'>stop_id</span>,
  <span class='no'>route_type</span>,
  <span class='kw'>route_id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>direction_id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>platform_numbers</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>departs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span>(),
  <span class='kw'>look_backwards</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>max_results</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>include_cancelled</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>validate_results</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>user_id</span> <span class='kw'>=</span> <span class='fu'>determine_user_id</span>(),
  <span class='kw'>api_key</span> <span class='kw'>=</span> <span class='fu'>determine_api_key</span>()
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>stop_id</th>
      <td><p>An integer stop ID returned by the <code>stops_on_route</code> or
<code>stops_nearby</code> functions.</p></td>
    </tr>
    <tr>
      <th>route_type</th>
      <td><p>A route type which can be provided either as a non-negative
integer code, or as a character: "Tram", "Train", "Bus", "Vline" or "Night
Bus". Character inputs are not case-sensitive. Use the <code>route_types</code>
function to extract a vector of all route types.</p></td>
    </tr>
    <tr>
      <th>route_id</th>
      <td><p>Optionally filter by a route ID. These can be obtained with
the <code>routes</code> function.</p></td>
    </tr>
    <tr>
      <th>direction_id</th>
      <td><p>Optionally filter by a direction ID. These can be
obtained with the <code>directions_on_route</code> function.</p></td>
    </tr>
    <tr>
      <th>platform_numbers</th>
      <td><p>Character vector. Optionally filter results by
platform number. Despite the name, these are characters.</p></td>
    </tr>
    <tr>
      <th>departs</th>
      <td><p>POSIXct or Character. Optionally filter results to departures
on or after the given value, according to either scheduled or estimated
departure time. Characters are automatically converted to datetimes, and
are assumed to be given as Melbourne time. Defaults to the current system
time.</p></td>
    </tr>
    <tr>
      <th>look_backwards</th>
      <td><p>Boolean. Whether to look before <code>departs</code>. Use with
caution (see Details). Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>max_results</th>
      <td><p>Integer. The maximum number of departures to return for
each route_id. Departures are ordered by estimated departure time, when
available, and scheduled departure time otherwise. When set to 0, all
departures after the given <code>departs</code> for the entire day are shown, and
potentially some in the early hours of the next morning. Defaults to 5.</p></td>
    </tr>
    <tr>
      <th>include_cancelled</th>
      <td><p>Logical. Whether results should be returned if they
have been cancelled. Metropolitan train services only. Defaults to FALSE.</p></td>
    </tr>
    <tr>
      <th>validate_results</th>
      <td><p>Boolean. If TRUE (the default), will apply additional
filters to ensure that the arguments to <code>departs</code>, <code>max_results</code>, and
<code>route_id</code> are respected if given.</p></td>
    </tr>
    <tr>
      <th>user_id</th>
      <td><p>Integer or character. A user ID or devid provided by Public
Transport Victoria. Refer to <code><a href='ptvapi.html'>?ptvapi</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>api_key</th>
      <td><p>Character. An API key, with dashes, provided by Public
Transport Victoria. Refer to <code><a href='ptvapi.html'>?ptvapi</a></code> for more details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble consisting of the following columns:</p><ul>
<li><p><code>stop_id</code></p></li>
<li><p><code>route_id</code></p></li>
<li><p><code>run_id</code></p></li>
<li><p><code>direction_id</code></p></li>
<li><p><code>disruption_ids</code></p></li>
<li><p><code>scheduled_departure</code></p></li>
<li><p><code>estimated_departure</code></p></li>
<li><p><code>at_platform</code></p></li>
<li><p><code>platform_number</code></p></li>
<li><p><code>flags</code></p></li>
<li><p><code>departure_sequence</code></p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Filtering departures: The API supports filtering by departure time,
to show the departures after the given time. However, its behaviour is
unpredictable, returning departures around the given time, both before and
after. We apply an additional filter once the results are retrieved to
ensure that only departures at or after the given <code>departs</code> datetime are
shown.</p>
<p>It's not clear what functionality <code>look_backwards</code> has. It's included here
regardless. Moreover, it's not clear how the API treats <code>route_id</code> or
<code>max_results</code>. We filter the results after retrieval, to ensure that
<code>departs</code>, <code>max_results</code>, and <code>route_id</code> are respected. This additional
validation can be disabled by setting <code>validate_results = TRUE</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'>departures</span>(<span class='kw'>stop_id</span> <span class='kw'>=</span> <span class='fl'>1071</span>, <span class='kw'>route_type</span> <span class='kw'>=</span> <span class='st'>"Train"</span>)
<span class='fu'>departures</span>(<span class='kw'>stop_id</span> <span class='kw'>=</span> <span class='fl'>1071</span>, <span class='kw'>route_type</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='fu'>departures</span>(
  <span class='kw'>stop_id</span> <span class='kw'>=</span> <span class='fl'>1071</span>,
  <span class='kw'>route_type</span> <span class='kw'>=</span> <span class='st'>"Train"</span>,
  <span class='kw'>platform_numbers</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>, <span class='fl'>5</span>)
)

<span class='fu'>departures</span>(
  <span class='kw'>stop_id</span> <span class='kw'>=</span> <span class='fl'>1071</span>,
  <span class='kw'>route_type</span> <span class='kw'>=</span> <span class='st'>"Train"</span>,
  <span class='kw'>route_id</span> <span class='kw'>=</span> <span class='fl'>6</span>
)

<span class='fu'>departures</span>(
  <span class='kw'>stop_id</span> <span class='kw'>=</span> <span class='fl'>1071</span>,
  <span class='kw'>route_type</span> <span class='kw'>=</span> <span class='st'>"Train"</span>,
  <span class='kw'>departs</span> <span class='kw'>=</span> <span class='st'>"2020-06-23 17:05:00"</span>
)

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Neuzerling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


